#!/bin/bash

temp="/tmp/temperature"
step=200
signal=5

if [ ! -f $temp ]; then
	current=$(hyprctl hyprsunset temperature)
	echo $current > $temp
else
	current=$(cat $temp)
fi

if [[ "$1" == "up" ]]; then
	new=$((current + step > 6000 ? 6000 : current + step))
elif [[ "$1" == "down" ]]; then
	new=$((current - step < 1000 ? 1000 : current - step))
elif [[ "$1" == "max" ]]; then
	new=6000
elif [[ "$1" == "min" ]]; then
	new=1000
elif [[ "$1" == "set" ]]; then
	new=$2
else
	new=$current
fi

echo "{\"text\":\"${new}\",\"percentage\":$(((new - 1000) / 50)),\"tooltip\":\"Temperature\"}"
pkill -RTMIN+$signal waybar

if [ "$new" -ne "$current" ]; then
	(hyprctl hyprsunset temperature $new -q) &
	echo $new > $temp
fi
